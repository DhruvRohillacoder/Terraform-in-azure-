trigger: none
#  branches:
#     include:
#       - main
pool:
  name: dhruvagent
variables:
 wd: '$(System.DefaultWorkingDirectory)/parent'

steps:
- task: TerraformInstaller@1
  inputs:
    terraformVersion: 'latest'

# - task: TerraformTask@5
#   inputs:
#     provider: 'azurerm'
#     command: 'init'
#     workingDirectory: $(wd)
#     backendServiceArm: 'terraconection'
#     backendAzureRmResourceGroupName: 'tfdhruvrg'
#     backendAzureRmStorageAccountName: 'tfdhruvstg'
#     backendAzureRmContainerName: 'tfstate'
#     backendAzureRmKey: 'terrapip.tfstate'

# - task: TerraformTask@5
#   inputs:
#     provider: 'azurerm'
#     command: 'validate'
#     workingDirectory: $(wd)

# - task: TerraformTask@5
#   inputs:
#     provider: 'azurerm'
#     command: 'plan'
#     workingDirectory: $(wd)
#     environmentServiceNameAzureRM: 'terraconection'

# - task: TerraformTask@5
#   inputs:
#     provider: 'azurerm'
#     command: 'apply'
#     workingDirectory: $(wd)
#     commandOptions: '--auto-approve'
#     environmentServiceNameAzureRM: 'terraconection'

# - task: AzureCLI@2
#   inputs:
#     azureSubscription: 'terraconection'
#     scriptType: 'ps'
#     scriptLocation: 'inlineScript'
#     inlineScript: 'terraform state list'
#     workingDirectory: $(wd)
